{"version":3,"sources":["../babel/app.js"],"names":["document","addEventListener","e","loadTemplate","window","templateId","$","on","copyTextarea","querySelector","select","successful","execCommand","msg","addClass","setTimeout","removeClass","err","evebt","currentTarget","attributes","value","checkIcon","target","parent","find","each","css","themeSource","loadTheme","append","activateLoader","API","getCv","data","domParser","DOMParser","template","parseFromString","templateHtml","getElementById","templateStyles","getElementsByTagName","html","isEditing","prepareToEditTemplate","setPlaceholders","placeholders","i","length","element","statusBarDom","statusBar","StatusBar","zones","Zone","blocks","Block","loader","createElement","loaderIcon","setAttribute","_element","_timer","closeButton","_hide","bind","undoButton","_isActive","message","classList","remove","messageEl","innerHTML","_show","Promise","resolve","reject","Rx","Observable","fromEvent","subscribe","clearTimeout","error","add","zone","_addBlock","_createAddBlock","_enableDragNDrop","zoneName","getAttribute","zoneTypes","JSON","parse","blockWrapper","button","_showAddBlockList","appendChild","zonesList","type","listItem","_addNewBlock","listImg","location","origin","listName","name","getBlock","block","newBlock","before","firstChild","editableElements","querySelectorAll","key","indexOf","sliders","slider","attr","range","min","max","slide","event","ui","after","showMessage","then","catch","reason","sortable","connectWith","items","handle","cancel","helper","appendTo","zIndex","delay","placeholder","activate","beforeStop","change","create","deactivate","out","over","receive","item","types","map","obj","sender","hasClass","sort","start","undefined","stop","update","_blockType","dataset","blockType","_childBlockType","_createControls","_fixPlaceholders","childBlockType","_createMicroBlockControls","_enableMicroBlockDragNDrop","blockActionsWrapper","itemPlaceholder","moveButton","editButton","edit","deleteButton","delete","cancelButton","saveButton","save","removeChild","el","deleteMicroBlock","_addMicroBlock","toggle","_isEditing","_toggleEditing","z","counter","blockId","keysCount","sameKeysCount","j","dataValue","dataKey","push","saveBlock","deleteBlock","parentNode","detach","cb","ajax","url","templateUrl","success","complete","apiUrl","decodeURIComponent","replace","cvId","method"],"mappings":"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","file":"app.js","sourcesContent":["document.addEventListener(\"DOMContentLoaded\", (e) => {\n    loadTemplate(window.templateId);\n});\n\n$('.edit-url-btn').on('click', () => {\n    var copyTextarea = document.querySelector('.edit-url');\n    copyTextarea.select();\n\n    try {\n        var successful = document.execCommand('copy');\n        var msg = successful ? 'successful' : 'unsuccessful';\n\n        $('.text-copied').addClass('active');\n        setTimeout(function () {\n            $('.text-copied').removeClass('active');\n        }, 500);\n    } catch (err) {\n    }\n});\n$('.template').on('click', (evebt) => {\n    let templateId = evebt.currentTarget.attributes[1].value;\n    let checkIcon = $(evebt.target).parent().find('.check-icon');\n\n    $('.templates-list .check-icon').each(function () {\n        $(this).css('display', 'none');\n    });\n    $(checkIcon).css('display', 'block');\n\n    loadTemplate(templateId);\n});\n$('.themes-listitem').on('click', (evebt) => {\n    let themeSource = evebt.currentTarget.attributes[1].value;\n    let checkIcon = $(evebt.target).parent().find('.check-icon');\n\n    $('.themes-list').find('.check-icon').each(function () {\n        $(this).css('display', 'none');\n    });\n\n    $(checkIcon).css('display', 'block');\n\n    loadTheme(themeSource);\n});\nlet loadTheme = (themeSource) => {\n    $('head').append(`<link href=\"/templates/default/${themeSource}\" rel=\"stylesheet\">`);\n};\nlet loadTemplate = (templateId) => {\n    activateLoader();\n    API.getCv(templateId, (data) => {\n        let domParser = new DOMParser();\n        let template = domParser.parseFromString(data, \"text/html\");\n        let templateHtml = template.getElementById('main-wrap');\n        let templateStyles = template.getElementsByTagName('link');\n\n        //Add template HTML\n        $('#template').html(templateHtml);\n\n        //Add template styles\n        $('head').append(templateStyles);\n\n        if (window.isEditing) {\n            prepareToEditTemplate();\n        }\n\n        setPlaceholders();\n\n        //Add timeout to remove twitches after loading template\n        setTimeout(() => {\n            $('#loader').removeClass('active');\n        }, 1000);\n    });\n}\n\nlet setPlaceholders = () => {\n    let placeholders = $('body').find(\"[data-placeholder]\");\n\n    for (let i = 0; i < placeholders.length; i++) {\n        let element = $(placeholders[i]);\n        let value = element.data('placeholder');\n        element.html(value);\n    }\n};\n\nlet prepareToEditTemplate = () => {\n    let statusBarDom = $('#status-bar');\n    window.statusBar = new StatusBar(statusBarDom);\n\n    //Setup zones\n    let zones = $('[data-zone-block-types]');\n    for (let i = 0; i < zones.length; i++) {\n        new Zone(zones[i]);\n    }\n\n    //Setup blocks\n    let blocks = $('[data-block-id]');\n    for (let i = 0; i < blocks.length; i++) {\n        new Block(blocks[i]);\n    }\n};\n\nlet activateLoader = () => {\n    let loader = document.createElement('div');\n    let loaderIcon = document.createElement('div');\n\n    loader.setAttribute('id', 'loader');\n    loader.setAttribute('class', 'active');\n    loaderIcon.setAttribute('class', 'signal');\n\n    loader.append(loaderIcon);\n\n    $('#template').append(loader);\n};\n\nclass StatusBar {\n    constructor(element) {\n        this._element = element[0];\n\n        var _timer;\n\n        let closeButton = this._element.querySelector('.close');\n        closeButton.addEventListener('click', this._hide.bind(this), false);\n\n        this.undoButton = this._element.querySelector('.action');\n\n        this._isActive = false;\n    }\n\n    showMessage(message) {\n        this._element.classList.remove('is-error');\n\n        let messageEl = this._element.querySelector('.message');\n        messageEl.innerHTML = message;\n        this._show();\n\n        return new Promise((resolve, reject) => {\n            _timer = setTimeout(() => {\n                this._hide();\n                resolve();\n            }, 5000);\n\n            Rx.Observable.fromEvent(this.undoButton, 'click')\n                .subscribe(() => {\n                    window.clearTimeout(_timer);\n                    this._hide();\n                    reject();\n                });\n        });\n    }\n\n    showError(error) {\n        this._element.classList.add('is-error');\n\n        let messageEl = this._element.querySelector('.message');\n        messageEl.innerHTML = error;\n\n        this._show();\n    }\n\n    _show() {\n        this._element.classList.add('is-active');\n        this._isActive = true;\n    }\n\n    _hide() {\n        this._element.classList.remove('is-active');\n        this._isActive = false;\n    }\n}\n\nclass Zone {\n    constructor(zone) {\n        this._addBlock = null;\n        this._element = zone;\n\n        this._createAddBlock();\n        this._enableDragNDrop();\n    }\n\n    _createAddBlock() {\n        const zoneName = this._element.getAttribute('data-zone');\n        const zoneTypes = JSON.parse(this._element.getAttribute('data-zone-block-types'));\n\n        let blockWrapper = document.createElement('div');\n        blockWrapper.classList.add('add-block');\n\n        let button = document.createElement('button');\n        button.innerHTML = 'Add block';\n        button.addEventListener('click', this._showAddBlockList.bind(this), false);\n        blockWrapper.appendChild(button);\n\n        let zonesList = document.createElement('ul');\n        zonesList.classList.add('add-block-items', 'clearfix');\n        blockWrapper.appendChild(zonesList);\n\n        for (let type of zoneTypes) {\n            let listItem = document.createElement('li');\n            listItem.addEventListener('click', () => this._addNewBlock(zoneName, type), false);\n\n            let listImg = document.createElement('img');\n            listImg.classList.add('icon');\n            listImg.setAttribute('src', `${window.location.origin}/img/add-block-${type.type}.png`);\n            listItem.appendChild(listImg);\n\n            let listName = document.createElement('span');\n            listName.classList.add('title');\n            listName.innerHTML = type.name;\n            listItem.appendChild(listName);\n\n            zonesList.appendChild(listItem);\n        }\n\n        this._element.appendChild(blockWrapper);\n        this._addBlock = blockWrapper;\n    }\n\n    _showAddBlockList() {\n        this._addBlock.classList.add('is-active');\n    }\n\n    _addNewBlock(zoneName, type) {\n        this._addBlock.classList.remove('is-active');\n\n        API.getBlock(type.type, (block) => {\n            let newBlock = $(block)[0];\n\n            $(`[data-zone=\"${zoneName}\"]`).find('.add-block').before(newBlock);\n            new Block(newBlock);\n\n            newBlock.firstChild.classList.add('is-editing');\n\n            let editableElements = this._element.querySelectorAll('[data-key]');\n            for (let i = 0; i < editableElements.length; i++) {\n                const key = editableElements[i].getAttribute('data-key');\n                if (['blocks'].indexOf(key) === -1) {\n                    editableElements[i].setAttribute('contenteditable', true);\n                }\n            }\n\n            let sliders = $(this._element).find('.skills');\n            for (let i = 0; i < sliders.length; i++) {\n                if ($(sliders[i]).parent().find('.slider').length === 0) {\n                    let slider = document.createElement('div');\n                    slider.classList.add('slider');\n                    let value = $(sliders[i]).parent('.skills-group').attr('data-value');\n                    $(slider).slider({\n                        range: 'max',\n                        min: 0,\n                        max: 10,\n                        value: value,\n                        slide: function (event, ui) {\n                            var value = ui.value;\n                            $(this).parent(\".skills-group\").attr(\"data-value\", ui.value);\n                        }\n                    });\n\n                    $(sliders[i]).after(slider);\n                }\n            }\n\n            window.statusBar.showMessage(`You have just added ${type.name} block`).then(function () {\n                // @TODO fix this when API will be done.\n            }).catch(function (reason) {\n\n            });\n        });\n    }\n\n    _enableDragNDrop() {\n        $(this._element).sortable({\n            connectWith: '[data-zone]',\n            items: '.item',\n            handle: '.move-block',\n            cancel: '',\n            helper: 'clone',\n            appendTo: 'body',\n            zIndex: 10000,\n            delay: 100,\n            placeholder: 'placeholder',\n            activate: (e, ui) => {\n            },\n            beforeStop: (e, ui) => {\n            },\n            change: (e, ui) => {\n            },\n            create: (e, ui) => {\n            },\n            deactivate: (e, ui) => {\n            },\n            out: (e, ui) => {\n            },\n            over: (e, ui) => {\n            },\n            receive: (e, ui) => {\n                let type = $(ui.item).data('blockType');\n                let types = $(e.target).data('zoneBlockTypes').map((obj) => obj.type);\n\n                if (types.indexOf(type) === -1) {\n                    $(ui.sender).sortable('cancel');\n                }\n\n                if ($(zones[i]).hasClass('ui-sortable')) {\n                    $('[data-zone]').sortable('enable');\n                }\n            },\n            remove: (e, ui) => {\n            },\n            sort: (e, ui) => {\n            },\n            start: (e, ui) => {\n                let type = $(ui.item).data('blockType');\n                let zones = $('[data-zone]');\n\n                for (let i = 0; i < zones.length; i++) {\n                    let types = [];\n                    if ($(zones[i]).data('zoneBlockTypes') !== undefined) {\n                        types = $(zones[i]).data('zoneBlockTypes').map((obj) => obj.type);\n                    }\n\n                    if (types.indexOf(type) === -1 && $(zones[i]).hasClass('ui-sortable')) {\n                        $(zones[i]).sortable('disable');\n                    }\n                }\n            },\n            stop: (e, ui) => {\n            },\n            update: (e, ui) => {\n            }\n        });\n    }\n}\n\nclass Block {\n    constructor(block) {\n        this._addBlock = null;\n        this._element = block;\n        this._blockType = block.dataset.blockType;\n        this._childBlockType = null;\n\n        this._createControls();\n        this._fixPlaceholders();\n\n        if ($(block).find('[data-key=\"blocks\"]').length != 0) {\n            this._childBlockType = $(block).find('[data-key=\"blocks\"]')[0].dataset.childBlockType;\n\n            this._createMicroBlockControls();\n            this._enableMicroBlockDragNDrop();\n            this._createAddBlock();\n        }\n    }\n\n    _createControls() {\n        let blockWrapper = document.createElement('div');\n        blockWrapper.classList.add('editable-block');\n\n        let blockActionsWrapper = document.createElement('div');\n        blockActionsWrapper.classList.add('block-actions');\n        blockWrapper.appendChild(blockActionsWrapper);\n\n        let itemPlaceholder = document.createElement('div');\n        itemPlaceholder.classList.add('item-placeholder');\n        itemPlaceholder.innerHTML = this._element.innerHTML;\n        blockWrapper.appendChild(itemPlaceholder);\n\n        if (JSON.parse(this._element.getAttribute('data-is-draggable')) === true) {\n            let moveButton = document.createElement('button');\n            moveButton.classList.add('move', 'move-block');\n            blockActionsWrapper.appendChild(moveButton);\n        }\n\n        if (JSON.parse(this._element.getAttribute('data-is-editable')) === true) {\n            let editButton = document.createElement('button');\n            editButton.classList.add('edit');\n            editButton.innerHTML = 'Edit';\n            editButton.addEventListener('click', this.edit.bind(this), false);\n            blockActionsWrapper.appendChild(editButton);\n        }\n\n        if (JSON.parse(this._element.getAttribute('data-is-deletable')) === true) {\n            let deleteButton = document.createElement('button');\n            deleteButton.classList.add('delete');\n            deleteButton.innerHTML = 'Delete';\n            deleteButton.addEventListener('click', this.delete.bind(this), false);\n            blockActionsWrapper.appendChild(deleteButton);\n        }\n\n        if (JSON.parse(this._element.getAttribute('data-is-editable')) === true) {\n            let cancelButton = document.createElement('button');\n            cancelButton.classList.add('cancel');\n            cancelButton.innerHTML = 'Cancel';\n            cancelButton.addEventListener('click', this.cancel.bind(this), false);\n            blockActionsWrapper.appendChild(cancelButton);\n        }\n\n        if (JSON.parse(this._element.getAttribute('data-is-editable')) === true) {\n            let saveButton = document.createElement('button');\n            saveButton.classList.add('save');\n            saveButton.innerHTML = 'Save';\n            saveButton.addEventListener('click', this.save.bind(this), false);\n            blockActionsWrapper.appendChild(saveButton);\n        }\n\n        while (this._element.firstChild) {\n            this._element.removeChild(this._element.firstChild);\n        }\n\n        this._element.appendChild(blockWrapper);\n    }\n\n    _fixPlaceholders() {\n        let placeholders = $(this._element).find('[data-placeholder]');\n        for (let i = 0; i < placeholders.length; i++) {\n            let el = $(placeholders[i])[0];\n            let placeholder = el.dataset.placeholder;\n            if (el.innerHTML.indexOf('{{') > -1) {\n                $(el).html(placeholder);\n            }\n        }\n    }\n\n    _createMicroBlockControls() {\n        $('[data-key=\"blocks\"] > div, [data-key=\"blocks\"] > li').addClass('editable-micro-block');\n\n        let blockActionsWrapper = document.createElement('div');\n        blockActionsWrapper.classList.add('block-actions');\n\n        let moveButton = document.createElement('button');\n        moveButton.classList.add('move', 'move-micro-block');\n        blockActionsWrapper.appendChild(moveButton);\n\n        let deleteButton = document.createElement('button');\n        deleteButton.classList.add('delete');\n        deleteButton.innerHTML = 'Delete';\n        $(deleteButton).on('click', this.deleteMicroBlock.bind(this));\n        blockActionsWrapper.appendChild(deleteButton);\n\n        $('[data-key=\"blocks\"] > div, [data-key=\"blocks\"] > li').remove('.block-actions');\n        $('[data-key=\"blocks\"] > div, [data-key=\"blocks\"] > li').append(blockActionsWrapper);\n    }\n\n    _enableMicroBlockDragNDrop() {\n        $('[data-key=\"blocks\"]').sortable({\n            // connectWith: '',\n            items: '> div, > li',\n            handle: '.move-micro-block',\n            cancel: '',\n            // helper: 'clone',\n            appendTo: 'body',\n            zIndex: 10000,\n            delay: 100,\n            placeholder: 'placeholder',\n            activate: (e, ui) => {\n            },\n            beforeStop: (e, ui) => {\n            },\n            change: (e, ui) => {\n            },\n            create: (e, ui) => {\n            },\n            deactivate: (e, ui) => {\n            },\n            out: (e, ui) => {\n            },\n            over: (e, ui) => {\n            },\n            receive: (e, ui) => {\n            },\n            remove: (e, ui) => {\n            },\n            sort: (e, ui) => {\n            },\n            start: (e, ui) => {\n            },\n            stop: (e, ui) => {\n            },\n            update: (e, ui) => {\n            }\n        });\n    }\n\n    _createAddBlock() {\n        let blockWrapper = document.createElement('div');\n        blockWrapper.classList.add('add-micro-block');\n\n        let button = document.createElement('button');\n        button.innerHTML = 'Add Micro block';\n        button.addEventListener('click', this._addMicroBlock.bind(this), false);\n        blockWrapper.appendChild(button);\n        $(this._element).find('.editable-block').append(blockWrapper);\n    }\n\n    _addMicroBlock() {\n        API.getBlock(this._childBlockType, (block) => {\n            $(this._element).find('[data-key=\"blocks\"]').append(block);\n            this._createMicroBlockControls();\n            this._fixPlaceholders();\n\n            //TODO: refactor edit function\n            let editableElements = this._element.querySelectorAll('[data-key]');\n            for (let i = 0; i < editableElements.length; i++) {\n                const key = editableElements[i].getAttribute('data-key');\n                if (['skill', 'blocks'].indexOf(key) === -1) {\n                    editableElements[i].setAttribute('contenteditable', true);\n                }\n            }\n        });\n    }\n\n    _toggleEditing() {\n        this._element.querySelector('.editable-block').classList.toggle('is-editing');\n        this._isEditing = !this._isEditing;\n    }\n\n    edit() {\n        let editableElements = this._element.querySelectorAll('[data-key]');\n        for (let i = 0; i < editableElements.length; i++) {\n            const key = editableElements[i].getAttribute('data-key');\n            if (['blocks'].indexOf(key) === -1) {\n                editableElements[i].setAttribute('contenteditable', true);\n            }\n        }\n\n        let sliders = $(this._element).find('.skills');\n        for (let i = 0; i < sliders.length; i++) {\n            if ($(sliders[i]).parent().find('.slider').length === 0) {\n                let slider = document.createElement('div');\n                slider.classList.add('slider');\n                let value = $(sliders[i]).parent('.skills-group').attr('data-value');\n                $(slider).slider({\n                    range: 'max',\n                    min: 0,\n                    max: 10,\n                    value: value,\n                    slide: function (event, ui) {\n                        var value = ui.value;\n                        $(this).parent(\".skills-group\").attr(\"data-value\", ui.value);\n                    }\n                });\n\n                $(sliders[i]).after(slider);\n            }\n        }\n\n        this._toggleEditing();\n    }\n\n    cancel() {\n        let editableElements = this._element.querySelectorAll('[data-key]');\n\n        for (let z = 0; z < editableElements.length; z++) {\n            if (['blocks'].indexOf(editableElements[z].getAttribute('data-key')) === -1) {\n                editableElements[z].setAttribute('contenteditable', false);\n            }\n        }\n\n        this._toggleEditing();\n        loadTemplate(window.templateId);\n    }\n\n    save() {\n        let editableElements = this._element.querySelectorAll('[data-key]');\n\n        //Data saving\n        let counter = 0;\n        let data = {};\n        data['blockId'] = this._element.dataset.blockId || 0;\n        data['blockType'] = this._element.dataset.blockType;\n        data['zone'] = $(this._element).parent().data('zone');\n        data['fields'] = {};\n\n\n        for (let i = 0; i < editableElements.length; i++) {\n\n            if (editableElements[i].getAttribute('data-key') !== 'blocks') {\n                if (data['fields']['blocks'] !== undefined) {\n                    const keysCount = $(this._element).find('[data-key=\"blocks\"]').find('[data-key]');\n                    const sameKeysCount = $(this._element).find('[data-key=\"blocks\"]').find('[data-key=\"' + keysCount[0].getAttribute('data-key') + '\"]')\n\n                    let obj = {};\n                    for (let j = 0; j < (keysCount.length / sameKeysCount.length); j++) {\n                        let dataValue = (editableElements[i + j].getAttribute('data-value')) ? editableElements[i + j].getAttribute('data-value') : editableElements[i + j].innerHTML;\n                        let dataKey = editableElements[i + j].getAttribute('data-key');\n                        obj[dataKey] = dataValue;\n                    }\n\n                    i += keysCount.length / sameKeysCount.length - 1;\n\n                    data['fields']['blocks'].push(obj);\n                }\n                else {\n                    data['fields'][editableElements[i].getAttribute('data-key')] = editableElements[i].innerHTML;\n                }\n            }\n            else {\n                data['fields']['blocks'] = [];\n            }\n        }\n\n        for (let z = 0; z < editableElements.length; z++) {\n            if (['blocks'].indexOf(editableElements[z].getAttribute('data-key')) === -1) {\n                editableElements[z].setAttribute('contenteditable', false);\n            }\n        }\n\n        API.saveBlock(data, () => {\n\n        });\n\n        this._toggleEditing();\n    }\n\n    delete() {\n        let blockId = this._element.getAttribute('data-block-id');\n        var element = this._element;\n        element.classList.add('hidden');\n        window.statusBar.showMessage('You have just deleted block').then(function () {\n            API.deleteBlock(blockId, () => {\n                element.parentNode.removeChild(element);\n            });\n        }).catch(function (reason) {\n            element.classList.remove('hidden');\n        });\n\n    }\n\n    deleteMicroBlock(e) {\n        $(e.target).parent().parent().detach();\n    }\n}\n\nconst API = {\n\n    getCv: (templateId, cb) => {\n        $.ajax({\n            url: `${window.templateUrl}${templateId}/template`,\n            success: (data) => {\n                cb(data);\n            },\n            complete: () => {\n            },\n            error: () => {\n            }\n        });\n    },\n\n    getBlock: (type, cb) => {\n        $.ajax({\n            url: `${apiUrl}/block/${window.templateId}/${type}`,\n            success: (data) => {\n                let block = decodeURIComponent(JSON.parse(data).data).replace(/\\+/g, ' ');\n\n                cb(block);\n            },\n            complete: () => {\n            },\n            error: () => {\n            }\n        });\n    },\n\n    saveBlock: (block, cb) => {\n        block.cvId = cvId;\n\n        if (block.blockId !== 0) {\n            $.ajax({\n                url: `${apiUrl}/block/${window.cvId}/${block.zone}/${block.blockId}`,\n                method: 'PUT',\n                data: block,\n                success: (data) => {\n                    cb(true);\n                },\n                complete: () => {\n                },\n                error: () => {\n                }\n            });\n        } else {\n            $.ajax({\n                url: `${apiUrl}/block/${window.cvId}/${block.zone}`,\n                method: 'POST',\n                data: block,\n                success: (data) => {\n                    cb(true);\n                },\n                complete: () => {\n                },\n                error: () => {\n                }\n            });\n        }\n    },\n\n    deleteBlock: (blockId, cb) => {\n        if (blockId !== undefined) {\n            $.ajax({\n                url: `${apiUrl}/block/${blockId}`,\n                method: 'DELETE',\n                success: (data) => {\n                    cb(true);\n                },\n                complete: () => {\n                },\n                error: () => {\n                }\n            });\n        }\n    }\n}"]}