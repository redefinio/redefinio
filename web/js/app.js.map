{"version":3,"sources":["../babel/app.js"],"names":["document","addEventListener","e","loadTemplate","window","templateId","$","on","copyTextarea","querySelector","select","successful","execCommand","msg","addClass","setTimeout","removeClass","err","evebt","currentTarget","attributes","value","checkIcon","target","parent","find","each","css","themeSource","loadTheme","append","activateLoader","API","getCv","data","domParser","DOMParser","template","parseFromString","templateHtml","getElementById","templateStyles","getElementsByTagName","html","isEditing","prepareToEditTemplate","setPlaceholders","placeholders","i","length","element","statusBarDom","statusBar","StatusBar","zones","Zone","blocks","Block","loader","createElement","loaderIcon","setAttribute","_element","_timer","closeButton","_hide","bind","undoButton","_isActive","message","classList","remove","messageEl","innerHTML","_show","Promise","resolve","reject","Rx","Observable","fromEvent","subscribe","clearTimeout","error","add","zone","_addBlock","_createAddBlock","_enableDragNDrop","zoneName","getAttribute","zoneTypes","JSON","parse","blockWrapper","button","_showAddBlockList","appendChild","zonesList","type","listItem","_addNewBlock","listImg","location","origin","listName","name","getBlock","block","newBlock","before","showMessage","then","catch","reason","sortable","connectWith","items","handle","cancel","helper","appendTo","zIndex","delay","placeholder","activate","ui","beforeStop","change","create","deactivate","out","over","receive","item","types","map","obj","indexOf","sender","hasClass","sort","start","undefined","stop","update","_blockType","dataset","blockType","_childBlockType","_createControls","_fixPlaceholders","childBlockType","_createMicroBlockControls","_enableMicroBlockDragNDrop","blockActionsWrapper","itemPlaceholder","moveButton","editButton","edit","deleteButton","delete","cancelButton","saveButton","save","firstChild","removeChild","el","deleteMicroBlock","_addMicroBlock","editableElements","querySelectorAll","key","toggle","_isEditing","sliders","slider","attr","range","min","max","slide","event","after","_toggleEditing","z","counter","blockId","keysCount","sameKeysCount","j","dataValue","dataKey","push","saveBlock","deleteBlock","parentNode","detach","cb","ajax","url","templateUrl","success","complete","apiUrl","decodeURIComponent","replace","cvId","method"],"mappings":"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","file":"app.js","sourcesContent":["document.addEventListener(\"DOMContentLoaded\", (e) => {\n  loadTemplate(window.templateId);\n});\n\n$('.edit-url-btn').on('click', () => {\n  var copyTextarea = document.querySelector('.edit-url');\n  copyTextarea.select();\n\n  try {\n    var successful = document.execCommand('copy');\n    var msg = successful ? 'successful' : 'unsuccessful';\n\n    $('.text-copied').addClass('active');\n    setTimeout(function() {\n      $('.text-copied').removeClass('active');\n    }, 500);\n  } catch (err) {}\n});\n$('.template').on('click', (evebt) => {\n  let templateId = evebt.currentTarget.attributes[1].value;\n  let checkIcon = $(evebt.target).parent().find('.check-icon');\n  \n  $('.templates-list .check-icon').each(function() {\n    $(this).css('display', 'none');\n  });\n  $(checkIcon).css('display', 'block');\n\n  loadTemplate(templateId);\n});\n$('.themes-listitem').on('click', (evebt) => {\n    let themeSource = evebt.currentTarget.attributes[1].value;\n    let checkIcon = $(evebt.target).parent().find('.check-icon');\n\n    $('.themes-list').find('.check-icon').each(function() {\n      $(this).css('display', 'none');\n    });\n\n    $(checkIcon).css('display', 'block');\n\n    loadTheme(themeSource);\n});\nlet loadTheme = (themeSource) => {\n    $('head').append(`<link href=\"/templates/default/${themeSource}\" rel=\"stylesheet\">`);\n};\nlet loadTemplate = (templateId) => {\n  activateLoader();\n  API.getCv(templateId, (data) => {\n    let domParser = new DOMParser();\n    let template = domParser.parseFromString(data, \"text/html\");\n    let templateHtml = template.getElementById('main-wrap');\n    let templateStyles = template.getElementsByTagName('link');\n\n    //Add template HTML\n    $('#template').html(templateHtml);\n\n    //Add template styles\n    $('head').append(templateStyles);\n\n    if(window.isEditing) {\n      prepareToEditTemplate();\n    }\n\n    setPlaceholders();\n\n    //Add timeout to remove twitches after loading template\n    setTimeout(() => {\n      $('#loader').removeClass('active');\n    }, 1000);\n  });\n}\n\nlet setPlaceholders = () => {\n    let placeholders = $('body').find(\"[data-placeholder]\");\n\n    for(let i = 0; i < placeholders.length; i++) {\n        let element = $(placeholders[i]);\n        let value = element.data('placeholder');\n        element.html(value);\n    }\n}\n\nlet prepareToEditTemplate = () => {\n  let statusBarDom = $('#status-bar');\n  window.statusBar = new StatusBar(statusBarDom);\n\n  //Setup zones\n  let zones = $('[data-zone-block-types]');\n  for (let i = 0; i < zones.length; i++) {\n    new Zone(zones[i]);\n  }\n\n  //Setup blocks\n  let blocks = $('[data-block-id]');\n  for (let i = 0; i < blocks.length; i++) {\n    new Block(blocks[i]);\n  }\n}\n\nlet activateLoader = () => {\n    let loader = document.createElement('div');\n    let loaderIcon = document.createElement('div');\n\n    loader.setAttribute('id', 'loader');\n    loader.setAttribute('class', 'active');\n    loaderIcon.setAttribute('class', 'signal');\n\n    loader.append(loaderIcon);\n\n    $('#template').append(loader);\n}\n\nclass StatusBar {\n  constructor(element) {\n    this._element = element[0];\n    \n    var _timer;\n\n    let closeButton = this._element.querySelector('.close');\n    closeButton.addEventListener('click', this._hide.bind(this), false);\n    \n    this.undoButton = this._element.querySelector('.action');\n\n    this._isActive = false;\n  }\n\n  showMessage(message) {\n    this._element.classList.remove('is-error');\n\n    let messageEl = this._element.querySelector('.message');\n    messageEl.innerHTML = message;\n    this._show();\n    \n    return new Promise((resolve, reject) => {  \n      _timer = setTimeout(() => {        \n        this._hide();\n        resolve();\n      }, 5000);\n      \n      Rx.Observable.fromEvent(this.undoButton, 'click')\n        .subscribe(() => {\n          window.clearTimeout(_timer);\n          this._hide();\n          reject();\n      });\n    });\n  }\n\n  showError(error) {\n    this._element.classList.add('is-error');\n\n    let messageEl = this._element.querySelector('.message');\n    messageEl.innerHTML = error;\n\n    this._show();\n  }\n\n  _show() {\n    this._element.classList.add('is-active');\n    this._isActive = true;\n  }\n\n  _hide() {\n    this._element.classList.remove('is-active');\n    this._isActive = false;\n  }\n}\n\nclass Zone {\n  constructor(zone) {\n    this._addBlock = null;\n    this._element = zone;\n\n    this._createAddBlock();\n    this._enableDragNDrop();\n  }\n\n  _createAddBlock() {\n    const zoneName = this._element.getAttribute('data-zone');\n    const zoneTypes = JSON.parse(this._element.getAttribute('data-zone-block-types'));\n\n    let blockWrapper = document.createElement('div');\n    blockWrapper.classList.add('add-block');\n\n    let button = document.createElement('button');\n    button.innerHTML = 'Add block';\n    button.addEventListener('click', this._showAddBlockList.bind(this), false);\n    blockWrapper.appendChild(button);\n\n    let zonesList = document.createElement('ul');\n    zonesList.classList.add('add-block-items', 'clearfix');\n    blockWrapper.appendChild(zonesList);\n\n    for(let type of zoneTypes) {\n      let listItem = document.createElement('li');\n      listItem.addEventListener('click', () => this._addNewBlock(zoneName, type), false);\n\n      let listImg = document.createElement('img');\n      listImg.classList.add('icon');\n      listImg.setAttribute('src', `${window.location.origin}/img/add-block-${type.type}.png`);\n      listItem.appendChild(listImg);\n\n      let listName = document.createElement('span');\n      listName.classList.add('title');\n      listName.innerHTML = type.name;\n      listItem.appendChild(listName);\n\n      zonesList.appendChild(listItem);\n    }\n\n    this._element.appendChild(blockWrapper);\n    this._addBlock = blockWrapper;\n  }\n\n  _showAddBlockList() {\n    this._addBlock.classList.add('is-active');\n  }\n\n  _addNewBlock(zoneName, type) {\n    this._addBlock.classList.remove('is-active');\n\n    API.getBlock(type.type, (block) => {\n      let newBlock = $(block)[0];\n\n      $(`[data-zone=\"${zoneName}\"]`).find('.add-block').before(newBlock);\n      new Block(newBlock);\n\n      window.statusBar.showMessage(`You have just added ${type.name} block`).then(function () {\n          // @TODO fix this when API will be done.\n      }).catch(function (reason) {\n\n      });\n    });\n  }\n\n  _enableDragNDrop() {\n    $(this._element).sortable({\n      connectWith: '[data-zone]',\n      items: '.item',\n      handle: '.move-block',\n      cancel: '',\n      helper: 'clone',\n      appendTo: 'body',\n      zIndex: 10000,\n      delay: 100,\n      placeholder: 'placeholder',\n      activate: (e, ui) => {},\n      beforeStop: (e, ui) => {},\n      change: (e, ui) => {},\n      create: (e, ui) => {},\n      deactivate: (e, ui) => {},\n      out: (e, ui) => {},\n      over: (e, ui) => {},\n      receive: (e, ui) => {\n        let type = $(ui.item).data('blockType');\n        let types = $(e.target).data('zoneBlockTypes').map((obj) => obj.type);\n\n        if (types.indexOf(type) === -1) {\n          $(ui.sender).sortable('cancel');\n        }\n\n        if ($(zones[i]).hasClass('ui-sortable')) {\n          $('[data-zone]').sortable('enable');\n        }\n      },\n      remove: (e, ui) => {},\n      sort: (e, ui) => {},\n      start: (e, ui) => {\n        let type = $(ui.item).data('blockType');\n        let zones = $('[data-zone]');\n\n        for(let i = 0; i < zones.length; i++) {\n          let types = [];\n          if ($(zones[i]).data('zoneBlockTypes') !== undefined) {\n            types = $(zones[i]).data('zoneBlockTypes').map((obj) => obj.type);\n          }\n\n          if (types.indexOf(type) === -1 && $(zones[i]).hasClass('ui-sortable')) {\n            $(zones[i]).sortable('disable');\n          }\n        }\n      },\n      stop: (e, ui) => {},\n      update: (e, ui) => {}\n    });\n  }\n}\n\nclass Block {\n  constructor(block) {\n    this._addBlock = null;\n    this._element = block;\n    this._blockType = block.dataset.blockType;\n    this._childBlockType = null;\n    \n    this._createControls();\n    this._fixPlaceholders();\n\n    if ($(block).find('[data-key=\"blocks\"]').length != 0) {\n      this._childBlockType = $(block).find('[data-key=\"blocks\"]')[0].dataset.childBlockType;\n\n      this._createMicroBlockControls();\n      this._enableMicroBlockDragNDrop();\n      this._createAddBlock();\n    }\n  }\n\n  _createControls() {\n    let blockWrapper = document.createElement('div');\n    blockWrapper.classList.add('editable-block');\n\n    let blockActionsWrapper = document.createElement('div');\n    blockActionsWrapper.classList.add('block-actions');\n    blockWrapper.appendChild(blockActionsWrapper);\n\n    let itemPlaceholder = document.createElement('div');\n    itemPlaceholder.classList.add('item-placeholder');\n    itemPlaceholder.innerHTML = this._element.innerHTML;\n    blockWrapper.appendChild(itemPlaceholder);\n\n    if (JSON.parse(this._element.getAttribute('data-is-draggable')) === true) {\n      let moveButton = document.createElement('button');\n      moveButton.classList.add('move', 'move-block');\n      blockActionsWrapper.appendChild(moveButton);\n    }\n\n    if (JSON.parse(this._element.getAttribute('data-is-editable')) === true) {\n      let editButton = document.createElement('button');\n      editButton.classList.add('edit');\n      editButton.innerHTML = 'Edit';\n      editButton.addEventListener('click', this.edit.bind(this), false);\n      blockActionsWrapper.appendChild(editButton);\n    }\n\n    if (JSON.parse(this._element.getAttribute('data-is-deletable')) === true) {\n      let deleteButton = document.createElement('button');\n      deleteButton.classList.add('delete');\n      deleteButton.innerHTML = 'Delete';\n      deleteButton.addEventListener('click', this.delete.bind(this), false);\n      blockActionsWrapper.appendChild(deleteButton);\n    }\n\n    if (JSON.parse(this._element.getAttribute('data-is-editable')) === true) {\n        let cancelButton = document.createElement('button');\n        cancelButton.classList.add('cancel');\n        cancelButton.innerHTML = 'Cancel';\n        cancelButton.addEventListener('click', this.cancel.bind(this), false);\n        blockActionsWrapper.appendChild(cancelButton);\n      }\n\n    if (JSON.parse(this._element.getAttribute('data-is-editable')) === true) {\n      let saveButton = document.createElement('button');\n      saveButton.classList.add('save');\n      saveButton.innerHTML = 'Save';\n      saveButton.addEventListener('click', this.save.bind(this), false);\n      blockActionsWrapper.appendChild(saveButton);\n    }\n\n    while (this._element.firstChild) {\n      this._element.removeChild(this._element.firstChild);\n    }\n\n    this._element.appendChild(blockWrapper);\n  }\n\n  _fixPlaceholders() {\n    let placeholders = $(this._element).find('[data-placeholder]');\n    for(let i = 0; i < placeholders.length; i++) {\n      let el = $(placeholders[i])[0];\n      let placeholder = el.dataset.placeholder;\n      if(el.innerHTML.indexOf('{{') > -1) {\n        $(el).html(placeholder);\n      }\n    }\n  }\n\n  _createMicroBlockControls() {\n    $('[data-key=\"blocks\"] > div, [data-key=\"blocks\"] > li').addClass('editable-micro-block');\n\n    let blockActionsWrapper = document.createElement('div');\n    blockActionsWrapper.classList.add('block-actions');\n\n    let moveButton = document.createElement('button');\n    moveButton.classList.add('move', 'move-micro-block');\n    blockActionsWrapper.appendChild(moveButton);\n\n    let deleteButton = document.createElement('button');\n    deleteButton.classList.add('delete');\n    deleteButton.innerHTML = 'Delete';\n    $(deleteButton).on('click', this.deleteMicroBlock.bind(this));\n    blockActionsWrapper.appendChild(deleteButton);\n\n    $('[data-key=\"blocks\"] > div, [data-key=\"blocks\"] > li').remove('.block-actions');\n    $('[data-key=\"blocks\"] > div, [data-key=\"blocks\"] > li').append(blockActionsWrapper);\n  }\n\n  _enableMicroBlockDragNDrop() {\n    $('[data-key=\"blocks\"]').sortable({\n      // connectWith: '',\n      items: '> div, > li',\n      handle: '.move-micro-block',\n      cancel: '',\n      // helper: 'clone',\n      appendTo: 'body',\n      zIndex: 10000,\n      delay: 100,\n      placeholder: 'placeholder',\n      activate: (e, ui) => {},\n      beforeStop: (e, ui) => {},\n      change: (e, ui) => {},\n      create: (e, ui) => {},\n      deactivate: (e, ui) => {},\n      out: (e, ui) => {},\n      over: (e, ui) => {},\n      receive: (e, ui) => {},\n      remove: (e, ui) => {},\n      sort: (e, ui) => {},\n      start: (e, ui) => {},\n      stop: (e, ui) => {},\n      update: (e, ui) => {}\n    });\n  }\n\n  _createAddBlock() {\n    let blockWrapper = document.createElement('div');\n    blockWrapper.classList.add('add-micro-block');\n\n    let button = document.createElement('button');\n    button.innerHTML = 'Add Micro block';\n    button.addEventListener('click', this._addMicroBlock.bind(this), false);\n    blockWrapper.appendChild(button);\n    $(this._element).find('.editable-block').append(blockWrapper);\n  }\n\n  _addMicroBlock() {\n    API.getBlock(this._childBlockType, (block) => {\n      $(this._element).find('[data-key=\"blocks\"]').append(block);\n      this._createMicroBlockControls();\n      this._fixPlaceholders();\n\n      //TODO: refactor edit function\n      let editableElements = this._element.querySelectorAll('[data-key]');\n      for (let i = 0; i < editableElements.length; i++) {\n        const key = editableElements[i].getAttribute('data-key');\n        if(['skill', 'blocks'].indexOf(key) === -1) {\n          editableElements[i].setAttribute('contenteditable', true);\n        }\n      }\n    });\n  }\n\n  _toggleEditing() {\n    this._element.querySelector('.editable-block').classList.toggle('is-editing');\n    this._isEditing = !this._isEditing;\n  }\n\n  edit() {\n    let editableElements = this._element.querySelectorAll('[data-key]');\n    for (let i = 0; i < editableElements.length; i++) {\n      const key = editableElements[i].getAttribute('data-key');\n      if(['blocks'].indexOf(key) === -1) {\n        editableElements[i].setAttribute('contenteditable', true);\n      }\n    }\n\n    let sliders = $(this._element).find('.skills');\n    for(let i = 0; i < sliders.length; i++) {\n      if($(sliders[i]).parent().find('.slider').length === 0) {\n        let slider = document.createElement('div');\n        slider.classList.add('slider');\n        let value = $(sliders[i]).parent('.skills-group').attr('data-value');\n        $(slider).slider({\n          range: 'max',\n          min: 0,\n          max: 10,\n          value: value,\n          slide: function( event, ui ) {\n              var value = ui.value;\n              $(this).parent(\".skills-group\").attr(\"data-value\", ui.value);\n          }\n        });\n\n        $(sliders[i]).after(slider);\n      }\n    }\n\n    this._toggleEditing();\n  }\n\n  cancel() {\n      let editableElements = this._element.querySelectorAll('[data-key]');\n\n      for (let z = 0; z < editableElements.length; z++) {\n          if (['blocks'].indexOf(editableElements[z].getAttribute('data-key')) === -1) {\n              editableElements[z].setAttribute('contenteditable', false);\n          }\n      }\n\n      this._toggleEditing();\n  }\n\n  save() {\n    let editableElements = this._element.querySelectorAll('[data-key]');\n\n    //Data saving\n    let counter = 0;\n    let data = {};\n    data['blockId'] = this._element.dataset.blockId || 0;\n    data['blockType'] = this._element.dataset.blockType;\n    data['zone'] = $(this._element).parent().data('zone'); \n    data['fields'] = {};\n\n\n    for (let i = 0; i < editableElements.length; i++) {\n\n      if(editableElements[i].getAttribute('data-key') !== 'blocks') {\n        if(data['fields']['blocks'] !== undefined) {  \n          const keysCount = $(this._element).find('[data-key=\"blocks\"]').find('[data-key]');\n          const sameKeysCount = $(this._element).find('[data-key=\"blocks\"]').find('[data-key=\"' + keysCount[0].getAttribute('data-key') + '\"]')\n\n          let obj = {};\n          for(let j = 0; j < (keysCount.length / sameKeysCount.length); j++) {\n            let dataValue = (editableElements[i + j].getAttribute('data-value'))? editableElements[i + j].getAttribute('data-value'): editableElements[i + j].innerHTML;\n            let dataKey = editableElements[i + j].getAttribute('data-key');\n            obj[dataKey] = dataValue;\n          }\n\n          i+= keysCount.length / sameKeysCount.length - 1;\n\n          data['fields']['blocks'].push(obj);\n        }\n        else {\n          data['fields'][editableElements[i].getAttribute('data-key')] = editableElements[i].innerHTML;  \n        }\n      }\n      else {\n        data['fields']['blocks'] = [];\n      }\n    }\n\n    for (let z = 0; z < editableElements.length; z++) {\n        if (['blocks'].indexOf(editableElements[z].getAttribute('data-key')) === -1) {\n            editableElements[z].setAttribute('contenteditable', false);\n        }\n    }\n\n    API.saveBlock(data, () => {\n\n    });\n\n    this._toggleEditing();\n  }\n\n  delete() {\n    let blockId = this._element.getAttribute('data-block-id');\n    var element = this._element;\n    element.classList.add('hidden');\n    window.statusBar.showMessage('You have just deleted block').then(function () {\n      API.deleteBlock(blockId, () => {\n        element.parentNode.removeChild(element);\n      });\n    }).catch(function (reason) {\n      element.classList.remove('hidden');\n    });\n\n  }\n\n  deleteMicroBlock(e) {\n    $(e.target).parent().parent().detach();\n  }\n};\n\nconst API = {\n\n  getCv: (templateId, cb) => {\n    $.ajax({\n      url: `${window.templateUrl}${templateId}/template`,\n      success: (data) => {\n        cb(data);\n      },\n      complete: () => {},\n      error: () => {}\n    });\n  },\n\n  getBlock: (type, cb) => {\n    $.ajax({\n      url: `${apiUrl}/block/${window.templateId}/${type}`,\n      success: (data) => {\n        let block = decodeURIComponent(JSON.parse(data).data).replace(/\\+/g, ' ');\n\n        cb(block);\n      },\n      complete: () => {},\n      error: () => {}\n    });\n  },\n\n  saveBlock: (block, cb) => {\n    block.cvId = cvId;\n\n    if (block.blockId !== 0) {\n      $.ajax({\n        url: `${apiUrl}/block/${window.cvId}/${block.zone}/${block.blockId}`,\n        method: 'PUT',\n        data: block,\n        success: (data) => {\n          cb(true);\n        },\n        complete: () => {},\n        error: () => {}\n      });\n    } else {\n      $.ajax({\n        url: `${apiUrl}/block/${window.cvId}/${block.zone}`,\n        method: 'POST',\n        data: block,\n        success: (data) => {\n          cb(true);\n        },\n        complete: () => {},\n        error: () => {}\n      });\n    }\n  },\n  \n  deleteBlock: (blockId, cb) => {\n    if (blockId !== undefined) {\n      $.ajax({\n        url: `${apiUrl}/block/${blockId}`,\n        method: 'DELETE',\n        success: (data) => {\n          cb(true);\n        },\n        complete: () => {},\n        error: () => {}\n      });\n    }\n  }\n}"]}