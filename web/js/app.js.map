{"version":3,"sources":["../babel/app.js"],"names":["_isEditing","_isChanged","document","addEventListener","e","statusBarDom","$","window","statusBar","StatusBar","loadTemplate","templateId","location","hash","referrer","editUrl","css","bind","on","copyTextarea","querySelector","select","successful","execCommand","msg","addClass","setTimeout","removeClass","err","evebt","trackEvent","currentTarget","attributes","value","checkIcon","target","parent","find","text","modal","event","getAttribute","setCheckIcon","API","publishTemplate","data","href","templateUrl","themeSource","themeId","each","updateTheme","loadTheme","submit","val","trim","sendFeedback","response","showMessage","then","showError","preventDefault","append","activateLoader","getCv","domParser","DOMParser","template","parseFromString","html","templateHtml","getElementById","templateStyles","getElementsByTagName","slice","remove","themes","isEditing","prepareToEditTemplate","toggleDateElements","setPlaceholders","pasteListeners","textBlocks","i","length","attribute","element","clipboardData","getData","innerHTML","elements","classList","add","parentElement","children","placeholders","stripTags","regex","replace","zones","Zone","blocks","Block","preapareBlockToEdit","block","loader","createElement","loaderIcon","setAttribute","applySliders","sliders","slider","attr","range","min","max","slide","ui","after","_element","_timer","closeButton","_hide","undoButton","_isActive","message","hideUndo","messageEl","_show","Promise","resolve","reject","Rx","Observable","fromEvent","subscribe","clearTimeout","error","show","hide","zone","_addBlock","_createAddBlock","_enableDragNDrop","zoneName","zoneTypes","JSON","parse","blockWrapper","button","_showAddBlockList","appendChild","zonesList","type","listItem","_addNewBlock","listImg","origin","listName","name","cancelButton","_hideAddBlockList","getBlock","newBlock","before","firstChild","editableElements","querySelectorAll","key","indexOf","sortable","connectWith","items","handle","cancel","helper","appendTo","zIndex","delay","placeholder","activate","beforeStop","change","create","deactivate","out","over","receive","item","types","map","obj","sender","sort","start","undefined","hasClass","stop","update","wildcard","positions","position","push","sortBlocks","_blockType","dataset","blockType","_childBlockType","_createControls","_fixPlaceholders","childBlockType","_createMicroBlockControls","_enableMicroBlockDragNDrop","leftblockActionsWrapper","blockActionsWrapper","itemPlaceholder","moveButton","editButton","edit","deleteButton","delete","saveButton","save","removeChild","el","deleteMicroBlock","_addMicroBlock","toggle","contains","_toggleEditing","blockId","z","renderBlock","_updateHtml","counter","keysCount","sameKeysCount","j","dataValue","dataKey","files","uploadPhoto","photo","saveBlock","deleteBlock","parentNode","catch","reason","detach","editable","category","ga","className","cb","url","apiUrl","ajax","success","complete","method","decodeURIComponent","cvId","FormData","cache","dataType","processData","contentType","async","payload"],"mappings":"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","file":"app.js","sourcesContent":["let _isEditing = false;\nlet _isChanged = false;\n\ndocument.addEventListener(\"DOMContentLoaded\", (e) => {\n    let statusBarDom = $('#status-bar');\n    window.statusBar = new StatusBar(statusBarDom);\n    loadTemplate(window.templateId);\n    \n    if (window.location.hash === \"#published\" && document.referrer === editUrl) {\n        $('.container-message').css('display', 'block');\n    }\n});\n\n$(window).bind('beforeunload', function(){\n    if (_isEditing) {\n        return 'Are you sure you want to leave? There are some unpublished changes.';\n    }\n});\n\n$('.edit-url-btn').on('click', () => {\n    var copyTextarea = document.querySelector('.edit-url');\n    copyTextarea.select();\n\n    try {\n        var successful = document.execCommand('copy');\n        var msg = successful ? 'successful' : 'unsuccessful';\n\n        $('.text-copied').addClass('active');\n        setTimeout(function () {\n            $('.text-copied').removeClass('active');\n        }, 500);\n    } catch (err) {\n    }\n});\n$('.template').on('click', (evebt) => {\n    trackEvent('CV', `Template changed: ${evebt.currentTarget.attributes[2].value}`);\n\n    let templateId = evebt.currentTarget.attributes[1].value;\n    let checkIcon = $(evebt.target).parent().find('.check-icon');\n    if (_isEditing) {\n        $('#myModal .modal-descriptipn').text('Your changes will not be saved if you swich template.');\n        $('#myModal').modal('show')\n        $('#myModal').on('click', 'button', (event) => {\n            if (event.currentTarget.getAttribute('data-action') === 'cancel') {\n                $('#myModal').modal('hide');\n            } else {\n                _isEditing = false;\n                loadTemplate(templateId);\n                setCheckIcon('.templates-list .check-icon', checkIcon);\n                $('#myModal').modal('hide');\n            }\n        });\n    } else if (_isChanged) {\n        $('#myModal .modal-descriptipn').text('Are you sure you want to leave? There are some unpublished changes.');\n        $('#myModal').modal('show')\n        $('#myModal').on('click', 'button', (event) => {\n            if (event.currentTarget.getAttribute('data-action') === 'cancel') {\n                $('#myModal').modal('hide');\n            } else {\n                _isChanged = false;\n                loadTemplate(templateId);\n                setCheckIcon('.templates-list .check-icon', checkIcon);\n                $('#myModal').modal('hide');\n            }\n        });\n    }\n    else {\n        loadTemplate(templateId);\n        setCheckIcon('.templates-list .check-icon', checkIcon);\n    }\n});\n\n$('#publish-button').on('click', (event) => {\n   API.publishTemplate((data) => {\n       window.location.href = templateUrl + \"#published\";\n   });\n});\n$('.themes-list').on('click', '.themes-listitem', (evebt) => {\n    trackEvent('CV', 'Theme changed');\n\n    let themeSource = $(evebt.currentTarget).data(\"themeSource\");\n    let checkIcon = $(evebt.target).parent().find('.check-icon');\n    let themeId = $(evebt.currentTarget).data(\"themeId\");\n\n    $('.themes-list').find('.check-icon').each(function () {\n        $(this).css('display', 'none');\n    });\n\n    API.updateTheme(themeId, (data) => {\n\n    });\n\n    $(checkIcon).css('display', 'block');\n    loadTheme(themeSource);\n});\n\n$('.topbar-feedback').on('click', (event) => {\n    $('#feedbackModal').modal('show');\n});\n\n$('#feedback-form').submit((event) => {\n    let text = $(\"#feedback-text\").val();\n    if ($.trim(text)) {\n        API.sendFeedback(text, (response) => {\n            $(\"#feedback-text\").val('');\n            $('#feedbackModal').modal('hide');\n            window.statusBar.showMessage('Your feedback was sent successfully. Thank you for your time!', true).then(() => {});\n        }, (response) => {\n            $(\"#feedback-text\").val('');\n            $('#feedbackModal').modal('hide');\n            window.statusBar.showError('Your feedback was unsuccessfully sent. Please try later!', true).then(() => {});\n        });\n    }\n\n    event.preventDefault();\n});\n\nlet loadTheme = (themeSource) => {\n    $('head').append(`<link href=\"/templates/${themeSource}\" rel=\"stylesheet\">`);\n};\nlet loadTemplate = (templateId) => {\n    window.templateId = templateId;\n\n    activateLoader();\n    API.getCv(templateId, (data) => {\n        let domParser = new DOMParser();\n        let template = domParser.parseFromString(data.html, \"text/html\");\n        let templateHtml = template.getElementById('main-wrap');\n        let templateStyles = template.getElementsByTagName('link');\n\n        //Add template styles\n        $('head').find('link').slice(2).remove();\n        $('head').append(templateStyles);\n\n\n        $('.themes-list').html(data.themes);\n\n        //Add timeout to remove twitches after loading template\n        setTimeout(() => {\n            $('#loader').removeClass('active');\n            $('#template').html(templateHtml);\n\n            if (window.isEditing) {\n                prepareToEditTemplate();\n            }\n            toggleDateElements();\n            setPlaceholders();\n            pasteListeners();\n        }, 1000);\n    });\n};\n\nlet pasteListeners = () => {\n    let textBlocks = $('body').find('[data-key]');\n\n    for(let i = 0; i < textBlocks.length; i++) {\n        let attribute = textBlocks[i].getAttribute('data-key');\n\n        if (attribute === \"blocks\" || attribute === \"skill\") {\n            continue;\n        }\n\n        textBlocks[i].addEventListener('paste', (event) => {\n            event.preventDefault();\n\n            let element = event.currentTarget;\n            let text = event.clipboardData.getData(\"text/plain\");\n            element.innerHTML = text;\n        }, false);\n    }\n}\n\nlet toggleDateElements = () => {\n    let elements = $('body').find(\"[data-placeholder]\");\n\n    for (let i = 0; i < elements.length; i++) {\n        let element = $(elements[i]);\n\n        if (element[0].getAttribute('data-placeholder') == 'Date from' && element.html() == 'Date from') {\n            element[0].classList.add('hidden');\n        } else if (element[0].getAttribute('data-placeholder') == 'Date to' && element.html() == 'Date to') {\n            element[0].parentElement.children[1].classList.add('hidden');\n            element[0].classList.add('hidden');\n        }\n    }\n}\n\nlet setPlaceholders = () => {\n    let placeholders = $('body').find(\"[data-placeholder]\");\n\n    for (let i = 0; i < placeholders.length; i++) {\n        let element = $(placeholders[i]);\n        if (element.html() == \"\") {\n            let value = element.data('placeholder');\n            element.html(value);\n        }\n    }\n};\n\nlet  stripTags = (html) => {\n    var regex = /(<([^>]+)>)/ig\n    html = html.replace(regex, \"\");\n    regex = /&(.*?);/ig;\n    html = html.replace(regex, \"\");\n\n    return html;\n};\nlet prepareToEditTemplate = () => {\n    //Setup zones\n    let zones = $('[data-zone-block-types]');\n    for (let i = 0; i < zones.length; i++) {\n        new Zone(zones[i]);\n    }\n\n    //Setup blocks\n    let blocks = $('[data-block-id]');\n    for (let i = 0; i < blocks.length; i++) {\n        new Block(blocks[i]);\n    }\n};\n\nlet preapareBlockToEdit = (block) => {\n    new Block(block);\n}\n\nlet activateLoader = () => {\n    let loader = document.createElement('div');\n    let loaderIcon = document.createElement('div');\n\n    loader.setAttribute('id', 'loader');\n    loader.setAttribute('class', 'active');\n    loaderIcon.setAttribute('class', 'signal');\n\n    loader.append(loaderIcon);\n\n    $('#template').append(loader);\n};\n\n\nlet applySliders = (element) => {\n    let sliders = $(element).find('.skills');\n    for (let i = 0; i < sliders.length; i++) {\n        if ($(sliders[i]).parent().find('.slider').length === 0) {\n            let slider = document.createElement('div');\n            slider.classList.add('slider');\n            let value = $(sliders[i]).parent('.skills-group').attr('data-value');\n            $(slider).slider({\n                range: 'max',\n                min: 0,\n                max: 10,\n                value: value,\n                slide: function (event, ui) {\n                    var value = ui.value;\n                    $(this).parent(\".skills-group\").attr(\"data-value\", ui.value);\n                }\n            });\n\n            $(sliders[i]).after(slider);\n        }\n    }\n};\n\nclass StatusBar {\n    constructor(element) {\n        this._element = element[0];\n\n        var _timer;\n\n        let closeButton = this._element.querySelector('.close');\n        closeButton.addEventListener('click', this._hide.bind(this), false);\n\n        this.undoButton = this._element.querySelector('.action');\n\n        this._isActive = false;\n    }\n\n    showMessage(message, hideUndo) {\n        this._element.classList.remove('is-error');\n\n        hideUndo ? this.undoButton.classList.add('hidden') : this.undoButton.classList.remove('hidden');\n\n        let messageEl = this._element.querySelector('.message');\n        messageEl.innerHTML = message;\n        this._show();\n\n        return new Promise((resolve, reject) => {\n            _timer = setTimeout(() => {\n                this._hide();\n                resolve();\n            }, 1500);\n\n            Rx.Observable.fromEvent(this.undoButton, 'click')\n                .subscribe(() => {\n                    window.clearTimeout(_timer);\n                    this._hide();\n                    reject();\n                });\n        });\n    }\n\n    showError(error) {\n        this._element.classList.add('is-error');\n\n        let messageEl = this._element.querySelector('.message');\n        messageEl.innerHTML = error;\n\n        this._show();\n\n        return new Promise((resolve, reject) => {\n            setTimeout(() => {\n                this._hide();\n                resolve();\n            }, 1500);\n        });\n    }\n\n    _show() {\n        $(this._element).show('slow');\n        this._isActive = true;\n    }\n\n    _hide() {\n        $(this._element).hide('slow');\n        this._isActive = false;\n    }\n}\n\nclass Zone {\n    constructor(zone) {\n        this._addBlock = null;\n        this._element = zone;\n\n        this._createAddBlock();\n        this._enableDragNDrop();\n    }\n\n    _createAddBlock() {\n        const zoneName = this._element.getAttribute('data-zone');\n        const zoneTypes = JSON.parse(this._element.getAttribute('data-zone-block-types'));\n\n        let blockWrapper = document.createElement('div');\n        blockWrapper.classList.add('add-block');\n\n        let button = document.createElement('button');\n        button.innerHTML = 'Add block';\n        button.addEventListener('click', this._showAddBlockList.bind(this), false);\n        blockWrapper.appendChild(button);\n\n        let zonesList = document.createElement('ul');\n        zonesList.classList.add('add-block-items', 'clearfix');\n        blockWrapper.appendChild(zonesList);\n\n        for (let type of zoneTypes) {\n            let listItem = document.createElement('li');\n            listItem.addEventListener('click', () => this._addNewBlock(zoneName, type), false);\n\n            let listImg = document.createElement('img');\n            listImg.classList.add('icon');\n            listImg.setAttribute('src', `${window.location.origin}/img/add-block-${type.type}.png`);\n            listItem.appendChild(listImg);\n\n            let listName = document.createElement('span');\n            listName.classList.add('title');\n            listName.innerHTML = type.name;\n            listItem.appendChild(listName);\n\n            zonesList.appendChild(listItem);\n        }\n\n        this._element.appendChild(blockWrapper);\n\n        let cancelButton = document.createElement('a');\n        cancelButton.classList.add('active', 'cancel-button');\n        cancelButton.innerHTML = 'Cancel';\n        cancelButton.addEventListener('click', this._hideAddBlockList.bind(this), false);\n        blockWrapper.appendChild(cancelButton);\n\n\n        this._addBlock = blockWrapper;\n    }\n\n    _showAddBlockList() {\n        this._addBlock.classList.add('is-active');\n    }\n\n    _hideAddBlockList() {\n        this._addBlock.classList.remove('is-active');\n    }\n\n    _addNewBlock(zoneName, type) {\n        trackEvent('CV', `Add block: ${type.name}`)\n\n        this._addBlock.classList.remove('is-active');\n\n        API.getBlock(type.type, (block) => {\n            let newBlock = $(block)[0];\n\n            $(`[data-zone=\"${zoneName}\"]`).find('.add-block').before(newBlock);\n            new Block(newBlock);\n\n            newBlock.firstChild.classList.add('is-editing');\n\n            let editableElements = newBlock.querySelectorAll('[data-key]');\n            for (let i = 0; i < editableElements.length; i++) {\n                const key = editableElements[i].getAttribute('data-key');\n                if (['blocks'].indexOf(key) === -1 && key != \"skill\") {\n                    editableElements[i].setAttribute('contenteditable', true);\n                }\n            }\n\n            _isEditing = true;\n\n            applySliders(newBlock);\n\n            setPlaceholders();\n\n            window.statusBar.showMessage(`You have just added ${type.name} block`, true).then(() => {});\n        });\n    }\n\n    _enableDragNDrop() {\n        $(this._element).sortable({\n            connectWith: '[data-zone]',\n            items: '.item',\n            handle: '.move-block',\n            cancel: '',\n            helper: 'clone',\n            appendTo: 'body',\n            zIndex: 10000,\n            delay: 100,\n            placeholder: 'placeholder',\n            activate: (e, ui) => {\n            },\n            beforeStop: (e, ui) => {\n            },\n            change: (e, ui) => {\n            },\n            create: (e, ui) => {\n            },\n            deactivate: (e, ui) => {\n            },\n            out: (e, ui) => {\n            },\n            over: (e, ui) => {\n            },\n            receive: (e, ui) => {\n                let type = $(ui.item).data('blockType');\n                let types = $(e.target).data('zoneBlockTypes').map((obj) => obj.type);\n\n                if (types.indexOf(type) === -1) {\n                    $(ui.sender).sortable('cancel');\n                }\n            },\n            remove: (e, ui) => {\n            },\n            sort: (e, ui) => {\n            },\n            start: (e, ui) => {\n                let type = $(ui.item).data('blockType');\n                let zones = $('[data-zone]');\n\n                for (let i = 0; i < zones.length; i++) {\n                    let types = [];\n                    let zone = $(zones[i]);\n                    if ($(zones[i]).data('zoneBlockTypes') !== undefined) {\n                        types = $(zones[i]).data('zoneBlockTypes').map((obj) => obj.type);\n                    }\n\n                    if (types.indexOf(type) === -1 && $(zones[i]).hasClass('ui-sortable')) {\n                        $(zones[i]).sortable('disable');\n                    }\n                }\n            },\n            stop: (e, ui) => {\n                let zones = $('[data-zone]');\n\n                for (let i = 0; i < zones.length; i++) {\n                    if ($(zones[i]).hasClass('ui-sortable')) {\n                        $(zones[i]).sortable('enable');\n                    }\n                }\n            },\n            update: (e, ui) => {\n                let parent = ui.item.parent('[data-zone]');\n                let wildcard = $(parent).data('zone');\n                let children = parent.find('[data-block-id]');\n\n                let positions = [];\n\n                for (let i = 0; i < children.length; i++) {\n                    let position = $(children[i]).data('blockId');\n                    positions.push(position);\n                }\n\n                API.sortBlocks(wildcard, positions, () => {\n\n                });\n\n            }\n        });\n    }\n}\n\nclass Block {\n    constructor(block) {\n        this._addBlock = null;\n        this._element = block;\n        this._blockType = block.dataset.blockType;\n        this._childBlockType = null;\n\n        this._createControls();\n        this._fixPlaceholders();\n\n        if ($(block).find('[data-key=\"blocks\"]').length != 0) {\n            this._childBlockType = $(block).find('[data-key=\"blocks\"]')[0].dataset.childBlockType;\n\n            this._createMicroBlockControls();\n            this._enableMicroBlockDragNDrop();\n            this._createAddBlock();\n        }\n    }\n\n    _createControls() {\n        let blockWrapper = document.createElement('div');\n        blockWrapper.classList.add('editable-block');\n        \n        let leftblockActionsWrapper = document.createElement('div');\n        leftblockActionsWrapper.classList.add('block-actions--left-side');\n        blockWrapper.appendChild(leftblockActionsWrapper);\n\n        let blockActionsWrapper = document.createElement('div');\n        blockActionsWrapper.classList.add('block-actions');\n        blockWrapper.appendChild(blockActionsWrapper);\n\n        let itemPlaceholder = document.createElement('div');\n        itemPlaceholder.classList.add('item-placeholder');\n        itemPlaceholder.innerHTML = this._element.innerHTML;\n        blockWrapper.appendChild(itemPlaceholder);\n\n        if (JSON.parse(this._element.getAttribute('data-is-draggable')) === true) {\n            let moveButton = document.createElement('button');\n            moveButton.classList.add('move', 'move-block');\n            blockActionsWrapper.appendChild(moveButton);\n        }\n\n        if (JSON.parse(this._element.getAttribute('data-is-editable')) === true) {\n            let editButton = document.createElement('button');\n            editButton.classList.add('edit');\n            editButton.innerHTML = 'Edit';\n            editButton.addEventListener('click', this.edit.bind(this), false);\n            blockActionsWrapper.appendChild(editButton);\n        }\n\n        if (JSON.parse(this._element.getAttribute('data-is-deletable')) === true) {\n            let deleteButton = document.createElement('button');\n            deleteButton.classList.add('delete');\n            deleteButton.innerHTML = 'Delete';\n            deleteButton.addEventListener('click', this.delete.bind(this), false);\n            blockActionsWrapper.appendChild(deleteButton);\n        }\n\n        if (JSON.parse(this._element.getAttribute('data-is-editable')) === true) {\n            let cancelButton = document.createElement('button');\n            cancelButton.classList.add('cancel');\n            cancelButton.innerHTML = 'Cancel';\n            cancelButton.addEventListener('click', this.cancel.bind(this), false);\n            leftblockActionsWrapper.appendChild(cancelButton);\n        }\n\n        if (JSON.parse(this._element.getAttribute('data-is-editable')) === true) {\n            let saveButton = document.createElement('button');\n            saveButton.classList.add('save');\n            saveButton.innerHTML = 'Save';\n            saveButton.addEventListener('click', this.save.bind(this), false);\n            blockActionsWrapper.appendChild(saveButton);\n        }\n\n        while (this._element.firstChild) {\n            this._element.removeChild(this._element.firstChild);\n        }\n\n        this._element.appendChild(blockWrapper);\n    }\n\n    _fixPlaceholders() {\n        let placeholders = $(this._element).find('[data-placeholder]');\n        for (let i = 0; i < placeholders.length; i++) {\n            let el = $(placeholders[i])[0];\n            let placeholder = el.dataset.placeholder;\n            if (el.innerHTML.indexOf('{{') > -1) {\n                $(el).html(placeholder);\n            }\n        }\n    }\n\n    _createMicroBlockControls() {\n        $('[data-key=\"blocks\"] > div, [data-key=\"blocks\"] > li').addClass('editable-micro-block');\n\n        let blockActionsWrapper = document.createElement('div');\n        blockActionsWrapper.classList.add('block-actions');\n\n        let moveButton = document.createElement('button');\n        moveButton.classList.add('move', 'move-micro-block');\n        blockActionsWrapper.appendChild(moveButton);\n\n        let deleteButton = document.createElement('button');\n        deleteButton.classList.add('delete');\n        deleteButton.innerHTML = 'Delete';\n        $(deleteButton).on('click', this.deleteMicroBlock.bind(this));\n        blockActionsWrapper.appendChild(deleteButton);\n\n        $('[data-key=\"blocks\"] > div, [data-key=\"blocks\"] > li').remove('.block-actions');\n        $('[data-key=\"blocks\"] > div, [data-key=\"blocks\"] > li').append(blockActionsWrapper);\n    }\n\n    _enableMicroBlockDragNDrop() {\n        $('[data-key=\"blocks\"]').sortable({\n            // connectWith: '',\n            items: '> div, > li',\n            handle: '.move-micro-block',\n            cancel: '',\n            // helper: 'clone',\n            appendTo: 'body',\n            zIndex: 10000,\n            delay: 100,\n            placeholder: 'placeholder',\n            activate: (e, ui) => {\n            },\n            beforeStop: (e, ui) => {\n            },\n            change: (e, ui) => {\n            },\n            create: (e, ui) => {\n            },\n            deactivate: (e, ui) => {\n            },\n            out: (e, ui) => {\n            },\n            over: (e, ui) => {\n            },\n            receive: (e, ui) => {\n            },\n            remove: (e, ui) => {\n            },\n            sort: (e, ui) => {\n            },\n            start: (e, ui) => {\n            },\n            stop: (e, ui) => {\n            },\n            update: (e, ui) => {\n            }\n        });\n    }\n\n    _createAddBlock() {\n        let blockWrapper = document.createElement('div');\n        blockWrapper.classList.add('add-micro-block');\n\n        let button = document.createElement('button');\n        button.innerHTML = 'Add Micro block';\n        button.addEventListener('click', this._addMicroBlock.bind(this), false);\n        blockWrapper.appendChild(button);\n        $(this._element).find('.editable-block').append(blockWrapper);\n    }\n\n    _addMicroBlock() {\n        trackEvent('CV', 'Add micro block');\n        \n        API.getBlock(this._childBlockType, (block) => {\n            $(this._element).find('[data-key=\"blocks\"]').append(block);\n            this._createMicroBlockControls();\n            this._fixPlaceholders();\n\n            applySliders(this._element);\n            setPlaceholders();\n\n            //TODO: refactor edit function\n            let editableElements = this._element.querySelectorAll('[data-key]');\n            for (let i = 0; i < editableElements.length; i++) {\n                const key = editableElements[i].getAttribute('data-key');\n                if (['skill', 'blocks'].indexOf(key) === -1 && key != \"skill\") {\n                    editableElements[i].setAttribute('contenteditable', true);\n                }\n            }\n        });\n    }\n\n    _toggleEditing() {\n        this._element.querySelector('.editable-block').classList.toggle('is-editing');\n        _isEditing = !_isEditing;\n    }\n\n    edit() {\n        let editableElements = this._element.querySelectorAll('[data-key]');\n        for (let i = 0; i < editableElements.length; i++) {\n            const key = editableElements[i].getAttribute('data-key');\n            if (['blocks'].indexOf(key) === -1 && key != \"skill\") {\n                editableElements[i].setAttribute('contenteditable', true);\n            }\n\n            if (editableElements[i].classList.contains('hidden')) {\n                editableElements[i].classList.remove('hidden');\n            }\n        }\n\n        applySliders(this._element);\n\n        this._toggleEditing();\n    }\n\n    cancel() {\n        let editableElements = this._element.querySelectorAll('[data-key]');\n        let blockId = this._element.getAttribute('data-block-id');\n\n        if (blockId == \"\") {\n            $(this._element).remove();\n        } else {\n\n            for (let z = 0; z < editableElements.length; z++) {\n                if (['blocks'].indexOf(editableElements[z].getAttribute('data-key')) === -1) {\n                    editableElements[z].setAttribute('contenteditable', false);\n                }\n            }\n\n            API.renderBlock(blockId, (response) => {\n                this._toggleEditing();\n                this._updateHtml(this._element, response.html, true);\n            });\n        }\n\n\n    }\n\n    save() {\n        let editableElements = this._element.querySelectorAll('[data-key]');\n\n        //Data saving\n        let counter = 0;\n        let data = {};\n        data['blockId'] = this._element.dataset.blockId || 0;\n        data['blockType'] = this._element.dataset.blockType;\n        data['zone'] = $(this._element).parent().data('zone');\n        data['fields'] = {};\n\n\n        for (let i = 0; i < editableElements.length; i++) {\n\n            if (editableElements[i].getAttribute('data-key') !== 'blocks') {\n                if (data['fields']['blocks'] !== undefined) {\n                    const keysCount = $(this._element).find('[data-key=\"blocks\"]').find('[data-key]');\n                    const sameKeysCount = $(this._element).find('[data-key=\"blocks\"]').find('[data-key=\"' + keysCount[0].getAttribute('data-key') + '\"]')\n\n                    let obj = {};\n                    for (let j = 0; j < (keysCount.length / sameKeysCount.length); j++) {\n                        let dataValue = (editableElements[i + j].getAttribute('data-value')) ? editableElements[i + j].getAttribute('data-value') : editableElements[i + j].innerHTML;\n                        let dataKey = editableElements[i + j].getAttribute('data-key');\n                        obj[dataKey] = this.stripTags(dataValue);\n                    }\n\n                    i += keysCount.length / sameKeysCount.length - 1;\n\n                    data['fields']['blocks'].push(obj);\n                }  else if (editableElements[i].getAttribute('data-key') == 'photo') {\n                    let files = editableElements[i].files;\n                    let key = editableElements[i].getAttribute('data-key');\n                    API.uploadPhoto(files, (response) => {\n                        data['fields'][key] = response.photo;\n                        $('.photo img').attr('src', response.photo);\n\n                    });\n                }\n                else {\n                    data['fields'][editableElements[i].getAttribute('data-key')] = this.stripTags(editableElements[i].innerHTML);\n                }\n            }\n            else {\n                data['fields']['blocks'] = [];\n            }\n        }\n\n        for (let z = 0; z < editableElements.length; z++) {\n            if (['blocks'].indexOf(editableElements[z].getAttribute('data-key')) === -1) {\n                editableElements[z].setAttribute('contenteditable', false);\n\n                if (editableElements[z].innerHTML == \"\") {\n                    if (editableElements[z].getAttribute('data-required')) {\n                        editableElements[z].innerHTML = editableElements[z].getAttribute('data-placeholder');\n                    } else {\n                        editableElements[z].classList.add('hidden');\n                    }\n                }\n            }\n        }\n\n        API.saveBlock(data, (response) => {\n            this._toggleEditing();\n            this._updateHtml(this._element, response.html, true);\n            window.statusBar.showMessage('Block successfully saved.', true).then(() => {});\n        });\n\n    }\n\n    stripTags(html) {\n        var regex = /(<([^>]+)>)/ig\n        html = html.replace(regex, \"\");\n        regex = /&(.*?);/ig;\n        html = html.replace(regex, \"\");\n\n        return html;\n    }\n\n    delete() {\n        trackEvent('CV', 'Remove block');\n\n        let blockId = this._element.getAttribute('data-block-id');\n        var element = this._element;\n        element.classList.add('hidden');\n        window.statusBar.showMessage('You have just deleted block', false).then(function () {\n            API.deleteBlock(blockId, () => {\n                element.parentNode.removeChild(element);\n            });\n        }).catch(function (reason) {\n            element.classList.remove('hidden');\n        });\n    }\n\n    deleteMicroBlock(e) {\n        $(e.target).parent().parent().detach();\n    }\n\n    _updateHtml(element, html, editable=false) {\n        $(element).html(html)\n        setPlaceholders();\n        toggleDateElements();\n        if (editable) {\n            preapareBlockToEdit(element);\n        }\n    }\n}\n\nfunction trackEvent(category, event) {\n    ga('send', 'event', category, event);\n}\n\nfunction setCheckIcon(className, checkIcon) {\n    $(className).each(function () {\n        $(this).css('display', 'none');\n    });\n    $(checkIcon).css('display', 'block');\n}\n\nconst API = {\n    \n    getCv: (templateId, cb) => {\n        let url = `${apiUrl}/${templateId}/template`;\n        if (templateId == undefined) {\n            url = `${apiUrl}/template`;\n        }\n        $.ajax({\n            url: url,\n            success: (data) => {\n                cb(data);\n            },\n            complete: () => {\n            },\n            error: () => {\n            }\n        });\n    },\n\n    renderBlock: (blockId, cb) => {\n        $.ajax({\n            url: `${apiUrl}/block/${blockId}`,\n            success: (data) => {\n                cb(data);\n            },\n            complete: () => {\n            },\n            error: () => {\n            }\n        });\n    },\n\n    updateTheme: (themeId, cb) => {\n        _isChanged = true;\n        let data = {\n            \"themeId\": themeId,\n            \"templateId\": window.templateId\n        }\n        $.ajax({\n            url: `${apiUrl}/theme`,\n            method: \"PUT\",\n            data: data,\n            success: (data) => {\n                cb(data);\n            },\n            complete: () => {\n            },\n            error: () => {\n            }\n        });\n    },\n\n    getBlock: (type, cb) => {\n        _isChanged = true;\n        $.ajax({\n            url: `${apiUrl}/block/${window.templateId}/${type}`,\n            success: (data) => {\n                let block = decodeURIComponent(JSON.parse(data).data).replace(/\\+/g, ' ');\n\n                cb(block);\n            },\n            complete: () => {\n            },\n            error: () => {\n            }\n        });\n    },\n\n    sendFeedback: (text, cb, error) => {\n        let data = {\n            \"message\": text\n        }\n        $.ajax({\n            url: `${apiUrl}/report`,\n            method: 'POST',\n            data: data,\n            success: (data) => {\n                cb(data);\n            },\n            complete: () => {},\n            error: (data) => {\n                error(data);\n            }\n        });\n    },\n\n    saveBlock: (block, cb) => {\n        _isChanged = true;\n        block.cvId = cvId;\n        block.templateId = window.templateId;\n\n        if (block.blockId !== 0) {\n            $.ajax({\n                url: `${apiUrl}/block/${block.zone}`,\n                method: 'PUT',\n                data: block,\n                success: (data) => {\n                    cb(data);\n                },\n                complete: () => {\n                },\n                error: () => {\n                }\n            });\n        } else {\n            $.ajax({\n                url: `${apiUrl}/block/${block.zone}`,\n                method: 'POST',\n                data: block,\n                success: (data) => {\n                    cb(data);\n                },\n                complete: () => {\n                },\n                error: () => {\n                }\n            });\n        }\n    },\n\n    uploadPhoto: (files, cb) => {\n        _isChanged = true;\n        var data = new FormData();\n        $.each(files, function (key, value) {\n           data.append(key, value);\n        });\n\n        $.ajax({\n            url: `${apiUrl}/photo`,\n            method: 'POST',\n            data: data,\n            cache: false,\n            dataType: 'json',\n            processData: false, // Don't process the files\n            contentType: false,\n            async: false,\n            success: (data) => {\n                cb(data);\n            }\n\n        })\n    },\n\n    deleteBlock: (blockId, cb) => {\n        _isChanged = true;\n        if (blockId !== undefined) {\n            $.ajax({\n                url: `${apiUrl}/block/${blockId}`,\n                method: 'DELETE',\n                success: (data) => {\n                    cb(true);\n                },\n                complete: () => {\n                },\n                error: () => {\n                }\n            });\n        }\n    },\n    sortBlocks: (wildcard, positions, cb) => {\n        _isChanged = true;\n        let payload = {};\n        payload['wildcard'] = wildcard;\n        payload['positions'] = positions;\n        payload['templateId'] = window.templateId;\n\n        $.ajax({\n            url: `${apiUrl}/zone`,\n            method: 'PUT',\n            data: payload,\n            success: (data) => {\n                cb(data);\n            },\n            error: () => {},\n            complete: () => {}\n\n        });\n    },\n    publishTemplate: (cb) => {\n        _isChanged = false;\n        let payload = {\n            'templateId': window.templateId\n        };\n\n        $.ajax({\n            url: `${apiUrl}/publish`,\n            method: 'PUT',\n            data: payload,\n            success: (data) => {\n                cb(data);\n            },\n            error: () => {},\n            complete: () => {}\n        });\n    }\n}\n"]}